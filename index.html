
<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>OVI API Reference</title>

    <style>
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight .gh {
  color: #999999;
}
.highlight .sr {
  color: #f6aa11;
}
.highlight .go {
  color: #888888;
}
.highlight .gp {
  color: #555555;
}
.highlight .gs {
}
.highlight .gu {
  color: #aaaaaa;
}
.highlight .nb {
  color: #f6aa11;
}
.highlight .cm {
  color: #75715e;
}
.highlight .cp {
  color: #75715e;
}
.highlight .c1 {
  color: #75715e;
}
.highlight .cs {
  color: #75715e;
}
.highlight .c, .highlight .cd {
  color: #75715e;
}
.highlight .err {
  color: #960050;
}
.highlight .gr {
  color: #960050;
}
.highlight .gt {
  color: #960050;
}
.highlight .gd {
  color: #49483e;
}
.highlight .gi {
  color: #49483e;
}
.highlight .ge {
  color: #49483e;
}
.highlight .kc {
  color: #66d9ef;
}
.highlight .kd {
  color: #66d9ef;
}
.highlight .kr {
  color: #66d9ef;
}
.highlight .no {
  color: #66d9ef;
}
.highlight .kt {
  color: #66d9ef;
}
.highlight .mf {
  color: #ae81ff;
}
.highlight .mh {
  color: #ae81ff;
}
.highlight .il {
  color: #ae81ff;
}
.highlight .mi {
  color: #ae81ff;
}
.highlight .mo {
  color: #ae81ff;
}
.highlight .m, .highlight .mb, .highlight .mx {
  color: #ae81ff;
}
.highlight .sc {
  color: #ae81ff;
}
.highlight .se {
  color: #ae81ff;
}
.highlight .ss {
  color: #ae81ff;
}
.highlight .sd {
  color: #e6db74;
}
.highlight .s2 {
  color: #e6db74;
}
.highlight .sb {
  color: #e6db74;
}
.highlight .sh {
  color: #e6db74;
}
.highlight .si {
  color: #e6db74;
}
.highlight .sx {
  color: #e6db74;
}
.highlight .s1 {
  color: #e6db74;
}
.highlight .s {
  color: #e6db74;
}
.highlight .na {
  color: #a6e22e;
}
.highlight .nc {
  color: #a6e22e;
}
.highlight .nd {
  color: #a6e22e;
}
.highlight .ne {
  color: #a6e22e;
}
.highlight .nf {
  color: #a6e22e;
}
.highlight .vc {
  color: #ffffff;
}
.highlight .nn {
  color: #ffffff;
}
.highlight .nl {
  color: #ffffff;
}
.highlight .ni {
  color: #ffffff;
}
.highlight .bp {
  color: #ffffff;
}
.highlight .vg {
  color: #ffffff;
}
.highlight .vi {
  color: #ffffff;
}
.highlight .nv {
  color: #ffffff;
}
.highlight .w {
  color: #ffffff;
}
.highlight {
  color: #ffffff;
}
.highlight .n, .highlight .py, .highlight .nx {
  color: #ffffff;
}
.highlight .ow {
  color: #f92672;
}
.highlight .nt {
  color: #f92672;
}
.highlight .k, .highlight .kv {
  color: #f92672;
}
.highlight .kn {
  color: #f92672;
}
.highlight .kp {
  color: #f92672;
}
.highlight .o {
  color: #f92672;
}
    </style>
    <link href="stylesheets/screen.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" media="print" />
      <script src="javascripts/all.js"></script>
  </head>

  <body class="index" data-languages="[&quot;shell&quot;,&quot;java&quot;]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" alt="Navbar" />
      </span>
    </a>
    <div class="toc-wrapper">
      <img src="images/logo.png" class="logo" alt="Logo" />
        <div class="lang-selector">
              <a href="#" data-language-name="shell">shell</a>
              <a href="#" data-language-name="java">java</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <div id="toc" class="toc-list-h1">
          <li>
            <a href="#introduction" class="toc-h1 toc-link" data-title="Introduction">Introduction</a>
          </li>
          <li>
            <a href="#authentication" class="toc-h1 toc-link" data-title="Authentication">Authentication</a>
          </li>
          <li>
            <a href="#configuration-set" class="toc-h1 toc-link" data-title="Configuration set">Configuration set</a>
          </li>
          <li>
            <a href="#ovmrequest" class="toc-h1 toc-link" data-title="OVMRequest">OVMRequest</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#post" class="toc-h2 toc-link" data-title="OVMRequest">post</a>
                  </li>
                  <li>
                    <a href="#roomstatusrequest" class="toc-h2 toc-link" data-title="OVMRequest">roomStatusRequest</a>
                  </li>
                  <li>
                    <a href="#foliorequest" class="toc-h2 toc-link" data-title="OVMRequest">folioRequest</a>
                  </li>
                  <li>
                    <a href="#expresscheckout" class="toc-h2 toc-link" data-title="OVMRequest">expressCheckout</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#ovmapi" class="toc-h1 toc-link" data-title="OVMAPI">OVMAPI</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#retrievemessagesrequest" class="toc-h2 toc-link" data-title="OVMAPI">retrieveMessagesRequest</a>
                  </li>
                  <li>
                    <a href="#deletemessagerequest" class="toc-h2 toc-link" data-title="OVMAPI">deleteMessageRequest</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#outgoingmessagecontroller" class="toc-h1 toc-link" data-title="OutGoingMessageController">OutGoingMessageController</a>
          </li>
          <li>
            <a href="#common-issues" class="toc-h1 toc-link" data-title="Common issues">Common issues</a>
          </li>
      </div>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id='introduction'>Introduction</h1>
<p>This document describes in detail the API between OVI and OVM. This document is intended for GTK developers only. In case this API document needs to be updated, please commit changes to the ovi-ovm-api repository in bitbucket.</p>
<h1 id='authentication'>Authentication</h1>
<p>In order to access the OVI API, the IP address of the calling system has to be cleared through OVI&#39;s firewall.</p>

<p>There are two places where the IP needs to be added in order to allow it through.</p>

<p><code>External IP allowed to use PMSi service. Use comma ( , ) to seperate the IPs.</code>
And
<code>servletConfig.allowedIp</code></p>

<aside class="notice">
These configurations are under: <br>
- Synapse > PMSi > Global Configurations
<br>
- OVI Console > Applications > Servlets
</aside>
<h1 id='configuration-set'>Configuration set</h1>
<p>Timeouts</p>
<h1 id='ovmrequest'>OVMRequest</h1>
<p>Simple servlet in OVI which is called by OVM to perform various actions. <br>
<code>End point reachable at https://ovi_ip/api/pmsi/OVMRequest</code>
<aside class="notice">
Accepts XML. Responds in XML
</aside></p>
<h2 id='post'>post</h2><pre class="highlight shell tab-shell"><code>curl -X POST -d <span class="se">\</span>
<span class="s2">"&lt;?xml version='1.0' encoding='UTF-8'?&gt; </span><span class="se">\</span><span class="s2">
&lt;post&gt; </span><span class="se">\</span><span class="s2">
&lt;room&gt;101&lt;/room&gt; </span><span class="se">\</span><span class="s2">
&lt;amount&gt;1295&lt;/amount&gt; </span><span class="se">\</span><span class="s2">
&lt;description&gt;MOVIE&lt;/description&gt; </span><span class="se">\</span><span class="s2">
&lt;detailDescription&gt;MOVIE-12911&lt;/detailDescription&gt; </span><span class="se">\</span><span class="s2">
&lt;/post&gt;"</span> <span class="se">\</span>
http://darekovi.rndguest.tk/api/pmsi/OVMRequest
</code></pre><pre class="highlight java tab-java"><code><span class="kd">const</span> <span class="n">kittn</span> <span class="o">=</span> <span class="n">require</span><span class="o">(</span><span class="err">'</span><span class="n">kittn</span><span class="err">'</span><span class="o">);</span>

<span class="n">let</span> <span class="n">api</span> <span class="o">=</span> <span class="n">kittn</span><span class="o">.</span><span class="na">authorize</span><span class="o">(</span><span class="err">'</span><span class="n">meowmeowmeow</span><span class="err">'</span><span class="o">);</span>
<span class="n">let</span> <span class="n">kittens</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="na">kittens</span><span class="o">.</span><span class="na">get</span><span class="o">();</span>
</code></pre>
<blockquote>
<p>The above command should return XML:</p>
</blockquote>
<pre class="highlight xml tab-xml"><code><span class="cp">&lt;?xml version="1.0" encoding="UTF-8" standalone="yes"?&gt;</span>
<span class="nt">&lt;postReply&gt;</span>
    <span class="nt">&lt;description&gt;&lt;/description&gt;</span>
    <span class="nt">&lt;result&gt;</span>true<span class="nt">&lt;/result&gt;</span>
    <span class="nt">&lt;status&gt;</span>no_error<span class="nt">&lt;/status&gt;</span>
<span class="nt">&lt;/postReply&gt;</span>
</code></pre>
<p>This call will post charges to the room.</p>
<h3 id='expected-xml-parameters'>Expected XML Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Example</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>room</td>
<td>110</td>
<td>room number where the charge should go to</td>
</tr>
<tr>
<td>amount</td>
<td>1095</td>
<td>Amount in cents how much the charge should be</td>
</tr>
<tr>
<td>description</td>
<td>MOVIE</td>
<td>PMS code to what the charge is for</td>
</tr>
<tr>
<td>detailDescription</td>
<td>MOVIE-1234</td>
<td>additional information</td>
</tr>
</tbody></table>
<h3 id='return-xml-paramters'>Return XML Paramters</h3>
<table><thead>
<tr>
<th>parameter name</th>
<th>values</th>
<th>description</th>
</tr>
</thead><tbody>
<tr>
<td>description</td>
<td>String</td>
<td>hardcoded as &quot;&quot;</td>
</tr>
<tr>
<td>result</td>
<td>true/false</td>
<td>Did this request go through successfully?</td>
</tr>
<tr>
<td>status</td>
<td>String</td>
<td>short description of the result</td>
</tr>
</tbody></table>
<h3 id='possible-status-response'>Possible STATUS Response</h3>
<table><thead>
<tr>
<th>result</th>
<th>status</th>
<th>reason</th>
</tr>
</thead><tbody>
<tr>
<td>true</td>
<td>no_error</td>
<td>posting went through successfully</td>
</tr>
<tr>
<td>false</td>
<td>unknown_room</td>
<td>This room does not exist in OVI</td>
</tr>
<tr>
<td>false</td>
<td>vacant_room</td>
<td>Room vacant</td>
</tr>
<tr>
<td>false</td>
<td>express_checkout_not_permitted</td>
<td>Room is inhibited</td>
</tr>
<tr>
<td>false</td>
<td>unsupported_message</td>
<td>Incorrect internal request format</td>
</tr>
<tr>
<td>false</td>
<td>unsupported_feature</td>
<td>PMSi not configured</td>
</tr>
<tr>
<td>false</td>
<td>invalid_account</td>
<td>Invalid account number</td>
</tr>
<tr>
<td>false</td>
<td>PMS_error</td>
<td>No response from the PMS</td>
</tr>
<tr>
<td>false</td>
<td>unknown_error</td>
<td>PMS response was unknown to OVI</td>
</tr>
</tbody></table>
<h2 id='roomstatusrequest'>roomStatusRequest</h2>
<p>Method to request the current status of the room in OVI.</p>
<pre class="highlight shell tab-shell"><code>curl -X POST -d <span class="s2">"&lt;?xml version='1.0' encoding='UTF-8'?&gt; </span><span class="se">\</span><span class="s2">
&lt;roomStatusRequest&gt; </span><span class="se">\</span><span class="s2">
&lt;room&gt;101&lt;/room&gt; </span><span class="se">\</span><span class="s2">
&lt;/roomStatusRequest&gt;"</span> http://darekovi.rndguest.tk/api/pmsi/OVMRequest
</code></pre><pre class="highlight java tab-java"><code><span class="kd">const</span> <span class="n">kittn</span> <span class="o">=</span> <span class="n">require</span><span class="o">(</span><span class="err">'</span><span class="n">kittn</span><span class="err">'</span><span class="o">);</span>

<span class="n">let</span> <span class="n">api</span> <span class="o">=</span> <span class="n">kittn</span><span class="o">.</span><span class="na">authorize</span><span class="o">(</span><span class="err">'</span><span class="n">meowmeowmeow</span><span class="err">'</span><span class="o">);</span>
<span class="n">let</span> <span class="n">kittens</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="na">kittens</span><span class="o">.</span><span class="na">get</span><span class="o">();</span>
</code></pre>
<blockquote>
<p>Example of the XML response for the above command:</p>
</blockquote>
<pre class="highlight xml tab-xml"><code><span class="cp">&lt;?xml version="1.0" encoding="UTF-8" standalone="yes"?&gt;</span>
<span class="nt">&lt;roomStatus&gt;</span>
    <span class="nt">&lt;checkin&gt;</span>true<span class="nt">&lt;/checkin&gt;</span>
    <span class="nt">&lt;guest&gt;</span>
        <span class="nt">&lt;accountNumber&gt;</span>101<span class="nt">&lt;/accountNumber&gt;</span>
        <span class="nt">&lt;checkinDate&gt;</span>2017-10-16<span class="nt">&lt;/checkinDate&gt;</span>
        <span class="nt">&lt;checkoutDate&gt;</span>2017-10-16<span class="nt">&lt;/checkoutDate&gt;</span>
        <span class="nt">&lt;country&gt;&lt;/country&gt;</span>
        <span class="nt">&lt;firstName&gt;&lt;/firstName&gt;</span>
        <span class="nt">&lt;fullName&gt;</span>Plum<span class="nt">&lt;/fullName&gt;</span>
        <span class="nt">&lt;groupNumber&gt;&lt;/groupNumber&gt;</span>
        <span class="nt">&lt;guestInhibit&gt;</span>false<span class="nt">&lt;/guestInhibit&gt;</span>
        <span class="nt">&lt;lastName&gt;</span>Plum<span class="nt">&lt;/lastName&gt;</span>
        <span class="nt">&lt;messageWaiting&gt;</span>none<span class="nt">&lt;/messageWaiting&gt;</span>
        <span class="nt">&lt;oldRoom&gt;&lt;/oldRoom&gt;</span>
        <span class="nt">&lt;paymentMethod&gt;</span>unknown<span class="nt">&lt;/paymentMethod&gt;</span>
        <span class="nt">&lt;primary&gt;</span>false<span class="nt">&lt;/primary&gt;</span>
        <span class="nt">&lt;rateCodeMap/&gt;</span>
        <span class="nt">&lt;sharedRoom&gt;</span>false<span class="nt">&lt;/sharedRoom&gt;</span>
        <span class="nt">&lt;title&gt;&lt;/title&gt;</span>
        <span class="nt">&lt;vip&gt;</span>false<span class="nt">&lt;/vip&gt;</span>
    <span class="nt">&lt;/guest&gt;</span>
    <span class="nt">&lt;inhibit&gt;</span>false<span class="nt">&lt;/inhibit&gt;</span>
    <span class="nt">&lt;resync&gt;</span>false<span class="nt">&lt;/resync&gt;</span>
    <span class="nt">&lt;room&gt;</span>101<span class="nt">&lt;/room&gt;</span>
<span class="nt">&lt;/roomStatus&gt;</span>

</code></pre><h3 id='expected-xml-parameters-2'>Expected XML parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Example</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>room</td>
<td>110</td>
<td>Requested room</td>
</tr>
</tbody></table>
<h3 id='return-response'>Return Response</h3>
<p>These responses correspond to the result XML message.
Possible responses from this endpoint:</p>

<table><thead>
<tr>
<th>parameter name</th>
<th>values</th>
<th>description</th>
</tr>
</thead><tbody>
<tr>
<td>checkin</td>
<td>true/false</td>
<td>Guest is checked in or not</td>
</tr>
<tr>
<td>guest</td>
<td>GuestInfo</td>
<td>GuestInfo object. See below for details</td>
</tr>
<tr>
<td>inhibit</td>
<td>true/false</td>
<td>Are charges allowed to this room</td>
</tr>
<tr>
<td>resync</td>
<td>true/false</td>
<td>Is OVI in resyc state?</td>
</tr>
<tr>
<td>room</td>
<td>String</td>
<td>Associated room name</td>
</tr>
</tbody></table>
<h3 id='guestinfo-object-parameters'>GuestInfo object parameters</h3>
<table><thead>
<tr>
<th>parameter name</th>
<th>values</th>
<th>description</th>
</tr>
</thead><tbody>
<tr>
<td>accountNumber</td>
<td>String</td>
<td>Guest PMS account number</td>
</tr>
<tr>
<td>checkinDate</td>
<td>Date</td>
<td>Guest&#39;s checkin date (YYYY-MM-DD)</td>
</tr>
<tr>
<td>checkoutDate</td>
<td>Date</td>
<td>Guest&#39;s checkout date(YYYY-MM-DD)</td>
</tr>
<tr>
<td>country</td>
<td>String</td>
<td>Country of origin</td>
</tr>
<tr>
<td>firstName</td>
<td>String</td>
<td>Guest&#39;s first name</td>
</tr>
<tr>
<td>fullName</td>
<td>String</td>
<td>Guest&#39;s unparsed full name</td>
</tr>
<tr>
<td>groupNumber</td>
<td>String</td>
<td>?</td>
</tr>
<tr>
<td>guestInhibit</td>
<td>boolean</td>
<td>Are charges allowed for this guest</td>
</tr>
<tr>
<td>lastName</td>
<td>String</td>
<td>Guest&#39;s last name</td>
</tr>
<tr>
<td>messageWaiting</td>
<td>none/undelivered/alldelivered</td>
<td>Any messages for the guest</td>
</tr>
<tr>
<td>oldRoom</td>
<td>String</td>
<td>Guest&#39;s old room</td>
</tr>
<tr>
<td>paymentMethod</td>
<td>cash/creditCard/unkown</td>
<td>Guest&#39;s payement type</td>
</tr>
<tr>
<td>primary</td>
<td>boolean</td>
<td>Is this guest the primary account holder</td>
</tr>
<tr>
<td>rateCodeMap</td>
<td>Array<String></td>
<td>ratecodes associated with this guest</td>
</tr>
<tr>
<td>sharedRoom</td>
<td>boolean</td>
<td>Is this room shared with another guest</td>
</tr>
<tr>
<td>title</td>
<td>String</td>
<td>Guest&#39;s title</td>
</tr>
<tr>
<td>vip</td>
<td>boolean</td>
<td>Is this guest considered a vip</td>
</tr>
</tbody></table>
<h2 id='foliorequest'>folioRequest</h2><pre class="highlight shell tab-shell"><code>curl -X POST -d <span class="s2">"&lt;?xml version='1.0' encoding='UTF-8'?&gt; </span><span class="se">\</span><span class="s2">
&lt;folio&gt; </span><span class="se">\</span><span class="s2">
&lt;room&gt;102&lt;/room&gt; </span><span class="se">\</span><span class="s2">
&lt;account&gt;102&lt;/account&gt; </span><span class="se">\</span><span class="s2">
&lt;/folio&gt;"</span> http://darekovi.rndguest.tk/api/pmsi/OVMRequest
</code></pre>
<blockquote>
<p>The example return XML:</p>
</blockquote>
<pre class="highlight xml tab-xml"><code><span class="cp">&lt;?xml version="1.0" encoding="UTF-8" standalone="yes"?&gt;</span>
<span class="nt">&lt;folioReply&gt;</span>
    <span class="nt">&lt;balance&gt;</span>0<span class="nt">&lt;/balance&gt;</span>
    <span class="nt">&lt;item&gt;</span>
        <span class="nt">&lt;amount&gt;</span>1000<span class="nt">&lt;/amount&gt;</span>
        <span class="nt">&lt;date&gt;</span>2017-10-16-06:00<span class="nt">&lt;/date&gt;</span>
        <span class="nt">&lt;description&gt;</span>STANDARD INTERNET<span class="nt">&lt;/description&gt;</span>
    <span class="nt">&lt;/item&gt;</span>
    <span class="nt">&lt;item&gt;</span>
        <span class="nt">&lt;amount&gt;</span>995<span class="nt">&lt;/amount&gt;</span>
        <span class="nt">&lt;date&gt;</span>2017-10-16-06:30<span class="nt">&lt;/date&gt;</span>
        <span class="nt">&lt;description&gt;</span>MOVIE-1234<span class="nt">&lt;/description&gt;</span>
    <span class="nt">&lt;/item&gt;</span>
    <span class="nt">&lt;result&gt;</span>true<span class="nt">&lt;/result&gt;</span>
    <span class="nt">&lt;status&gt;</span>no_error<span class="nt">&lt;/status&gt;</span>
<span class="nt">&lt;/folioReply&gt;</span>
</code></pre><h3 id='expected-xml-parameters-3'>Expected XML Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Example</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>room</td>
<td>110</td>
<td>room number for the folio request</td>
</tr>
<tr>
<td>account</td>
<td>110</td>
<td>account number for the folio request</td>
</tr>
</tbody></table>
<h3 id='return-xml-paramters-2'>Return XML Paramters</h3>
<table><thead>
<tr>
<th>parameter name</th>
<th>values</th>
<th>description</th>
</tr>
</thead><tbody>
<tr>
<td>balance</td>
<td>integer</td>
<td>total folio balance. Default -1 if no balance available</td>
</tr>
<tr>
<td>result</td>
<td>true/false</td>
<td>Did this request go through successfully?</td>
</tr>
<tr>
<td>item</td>
<td>Array<FolioItem></td>
<td>List of FolioItem objects. See below for details</td>
</tr>
<tr>
<td>status</td>
<td>String</td>
<td>possible status responses. See below for details</td>
</tr>
<tr>
<td>description</td>
<td>String</td>
<td>short description for this response</td>
</tr>
</tbody></table>
<h3 id='folioitem-object-parameters'>FolioItem object parameters</h3>
<table><thead>
<tr>
<th>parameter name</th>
<th>values</th>
<th>description</th>
</tr>
</thead><tbody>
<tr>
<td>amount</td>
<td>integer</td>
<td>Charge amount</td>
</tr>
<tr>
<td>description</td>
<td>String</td>
<td>Folio description of the item</td>
</tr>
<tr>
<td>date</td>
<td>Date</td>
<td>Charge date (YYYY-MM-DD-HH:MM)</td>
</tr>
<tr>
<td>location</td>
<td>String</td>
<td>Optional.</td>
</tr>
</tbody></table>
<h3 id='possible-status-response-2'>Possible STATUS Response</h3>
<table><thead>
<tr>
<th>result</th>
<th>status</th>
<th>reason</th>
</tr>
</thead><tbody>
<tr>
<td>true</td>
<td>no_error</td>
<td>posting went through successfully</td>
</tr>
<tr>
<td>false</td>
<td>unknown_room</td>
<td>This room does not exist in OVI</td>
</tr>
<tr>
<td>false</td>
<td>vacant_room</td>
<td>Room vacant</td>
</tr>
<tr>
<td>false</td>
<td>express_checkout_not_permitted</td>
<td>Room is inhibited</td>
</tr>
<tr>
<td>false</td>
<td>unsupported_message</td>
<td>Incorrect internal request format</td>
</tr>
<tr>
<td>false</td>
<td>unsupported_feature</td>
<td>PMSi not configured</td>
</tr>
<tr>
<td>false</td>
<td>invalid_account</td>
<td>Invalid account number</td>
</tr>
<tr>
<td>false</td>
<td>PMS_error</td>
<td>No response from the PMS</td>
</tr>
<tr>
<td>false</td>
<td>unknown_error</td>
<td>PMS response was unknown to OVI</td>
</tr>
</tbody></table>
<h2 id='expresscheckout'>expressCheckout</h2><pre class="highlight shell tab-shell"><code>url -X POST -d <span class="s2">"&lt;?xml version='1.0' encoding='UTF-8'?&gt; </span><span class="se">\</span><span class="s2">
&lt;expressCheckout&gt; </span><span class="se">\</span><span class="s2">
&lt;room&gt;100&lt;/room&gt; </span><span class="se">\</span><span class="s2">
&lt;account&gt;100&lt;/account&gt; </span><span class="se">\</span><span class="s2">
&lt;balance&gt;1000&lt;/balance&gt; </span><span class="se">\</span><span class="s2">
&lt;/expressCheckout&gt;"</span> http://darekovi.rndguest.tk/api/pmsi/OVMRequest
</code></pre>
<blockquote>
<p>The above command returns example XML:</p>
</blockquote>
<pre class="highlight xml tab-xml"><code><span class="cp">&lt;?xml version="1.0" encoding="UTF-8" standalone="yes"?&gt;</span>
<span class="nt">&lt;expressCheckoutReply&gt;</span>
    <span class="nt">&lt;description&gt;&lt;/description&gt;</span>
    <span class="nt">&lt;result&gt;</span>true<span class="nt">&lt;/result&gt;</span>
    <span class="nt">&lt;status&gt;</span>no_error<span class="nt">&lt;/status&gt;</span>
<span class="nt">&lt;/expressCheckoutReply&gt;</span>
</code></pre><h3 id='expected-xml-parameters-4'>Expected XML Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Example</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>room</td>
<td>110</td>
<td>room number for the folio request</td>
</tr>
<tr>
<td>account</td>
<td>110</td>
<td>account number for the folio request</td>
</tr>
<tr>
<td>balance</td>
<td>1295</td>
<td>Total balance of the folio. Has to match the current folio balance for this room.</td>
</tr>
</tbody></table>
<h3 id='return-xml-paramters-3'>Return XML Paramters</h3>
<table><thead>
<tr>
<th>parameter name</th>
<th>values</th>
<th>description</th>
</tr>
</thead><tbody>
<tr>
<td>description</td>
<td>String</td>
<td>Description from PMS</td>
</tr>
<tr>
<td>result</td>
<td>boolean</td>
<td>Did this request go through successfully?</td>
</tr>
<tr>
<td>status</td>
<td>String</td>
<td>short description of the result</td>
</tr>
</tbody></table>
<h3 id='possible-status-response-3'>Possible STATUS Response</h3>
<table><thead>
<tr>
<th>result</th>
<th>status</th>
<th>reason</th>
</tr>
</thead><tbody>
<tr>
<td>true</td>
<td>no_error</td>
<td>posting went through successfully</td>
</tr>
<tr>
<td>false</td>
<td>unknown_room</td>
<td>This room does not exist in OVI</td>
</tr>
<tr>
<td>false</td>
<td>vacant_room</td>
<td>Room vacant</td>
</tr>
<tr>
<td>false</td>
<td>express_checkout_not_permitted</td>
<td>Room is inhibited</td>
</tr>
<tr>
<td>false</td>
<td>unsupported_message</td>
<td>Incorrect internal request format</td>
</tr>
<tr>
<td>false</td>
<td>unsupported_feature</td>
<td>PMSi not configured</td>
</tr>
<tr>
<td>false</td>
<td>invalid_account</td>
<td>Invalid account number</td>
</tr>
<tr>
<td>false</td>
<td>PMS_error</td>
<td>No response from the PMS or balance mismatch</td>
</tr>
<tr>
<td>false</td>
<td>unknown_error</td>
<td>PMS response was unknown to OVI</td>
</tr>
</tbody></table>
<h1 id='ovmapi'>OVMAPI</h1>
<p>Endpoint in OVI which is called by OVM to get or delete messages which are stored in the PMS from the front desk.
These messages are displayed on TVs for hotel guests.</p>

<p><code>End point reachable at https://ovi_ip/api/pmsi/OVMAPI</code>
<aside class="notice">
Accepts JSON. Responds in JSON
</aside></p>

<aside class="success">
Only supported by `FIAS` interface
</aside>
<h2 id='retrievemessagesrequest'>retrieveMessagesRequest</h2>
<p>A way of retrieving messages which are stored in the PMS for the guest. These can be entered by the front desk.</p>
<h3 id='expected-json-parameters'>Expected JSON Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Example</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>room</td>
<td>110</td>
<td>room number for the folio request</td>
</tr>
<tr>
<td>accountId</td>
<td>110</td>
<td>account number for the folio request</td>
</tr>
</tbody></table>
<h3 id='return-xml-paramters-4'>Return XML Paramters</h3>
<p>TBD</p>
<pre class="highlight shell tab-shell"><code>curl -X POST -d <span class="s2">"{ </span><span class="se">\</span><span class="s2">
</span><span class="se">\"</span><span class="s2">roomNumber</span><span class="se">\"</span><span class="s2">: </span><span class="se">\"</span><span class="s2">101</span><span class="se">\"</span><span class="s2">,</span><span class="se">\</span><span class="s2">
</span><span class="se">\"</span><span class="s2">accountId</span><span class="se">\"</span><span class="s2">: </span><span class="se">\"</span><span class="s2">101</span><span class="se">\"\</span><span class="s2">
}"</span> http://darekovi.rndguest.tk/api/pmsi/OVMAPI
</code></pre>
<blockquote>
<p>Should return this json</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"messages"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">""</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><h2 id='deletemessagerequest'>deleteMessageRequest</h2>
<p>A way of deleting messages which are stored in the PMS</p>
<h3 id='expected-json-parameters-2'>Expected JSON Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Example</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>roomNumber</td>
<td>110</td>
<td>room number for the folio request</td>
</tr>
<tr>
<td>accountId</td>
<td>110</td>
<td>account number for the folio request</td>
</tr>
<tr>
<td>messageId</td>
<td>001</td>
<td>id of the message that needs to be removed in the PMS</td>
</tr>
</tbody></table>
<h3 id='expected-result'>Expected result</h3>
<table><thead>
<tr>
<th>parameter name</th>
<th>values</th>
<th>description</th>
</tr>
</thead><tbody>
<tr>
<td>result</td>
<td>boolean</td>
<td>result of the removal</td>
</tr>
</tbody></table>
<pre class="highlight shell tab-shell"><code>curl -X POST -d <span class="s2">"{ </span><span class="se">\</span><span class="s2">
</span><span class="se">\"</span><span class="s2">roomNumber</span><span class="se">\"</span><span class="s2">: </span><span class="se">\"</span><span class="s2">101</span><span class="se">\"</span><span class="s2">,</span><span class="se">\</span><span class="s2">
</span><span class="se">\"</span><span class="s2">accountId</span><span class="se">\"</span><span class="s2">: </span><span class="se">\"</span><span class="s2">101</span><span class="se">\"</span><span class="s2">,</span><span class="se">\</span><span class="s2">
</span><span class="se">\"</span><span class="s2">messageId</span><span class="se">\"</span><span class="s2">: </span><span class="se">\"</span><span class="s2">001</span><span class="se">\"\</span><span class="s2">
}"</span> http://darekovi.rndguest.tk/api/pmsi/OVMAPI
</code></pre>
<blockquote>
<p>Should return this json</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"result"</span><span class="p">:</span><span class="kc">true</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><h1 id='outgoingmessagecontroller'>OutGoingMessageController</h1>
<p>This endpoint is used for sending messages to OVM.</p>
<h1 id='common-issues'>Common issues</h1>
<aside class="notice">TBD</aside>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="shell">shell</a>
                <a href="#" data-language-name="java">java</a>
          </div>
      </div>
    </div>
  </body>
</html>
